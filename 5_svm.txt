# install.packages("dplyr") 
library(dplyr) 
# install.packages("e1071") 
library(e1071) 
# install.packages("caret") 
library(caret) 
# install.packages("ggplot2") 
library(ggplot2) 
# install.packages("lattice") 
library(lattice) 
rm(list=ls()) 
data = read.csv("social.csv") 
data = sample_n(data, 80) 
data = data[3:5] 
data$Purchased = factor(data$Purchased, levels=c(0, 1)) 
data_train <- sample_n(data, 0.9*length(data$Purchased)) 
data_test <- setdiff(data, data_train) 
data_train[-3] <- scale(data_train[-3]) 
data_test[-3] <- scale(data_test[-3]) 
SVMClassifier = svm(formula = Purchased ~ ., data=data_train, 
type="C-classification", kernel="linear") 
plot(SVMClassifier, data_train) 
yp = predict(SVMClassifier, newdata=data_test[-3]) 
confusionMatrix(table(yp, data_test$Purchased)) 
data_test$Purchased